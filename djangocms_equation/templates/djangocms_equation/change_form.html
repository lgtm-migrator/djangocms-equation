{% extends change_form_template|default:"admin/cms/page/plugin/change_form.html" %}
{% load cms_static %}

{% block extrahead %}
{{ block.super }}

<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css"
    integrity="sha384-dbVIfZGuN1Yq7/1Ocstc1lUEm+AT+/rCkibIcC/OmWo5f0EA48Vf8CytHzGrSwbQ"
    crossorigin="anonymous"
/>

<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"
    integrity="sha384-2BKqo+exmr9su6dir+qCw08N2ZKRucY4PrGQPPWU1A7FtlCGjmEGFqXCv5nyM5Ij"
    crossorigin="anonymous"
></script>

<!-- To automatically render math in text elements, include the auto-render extension: -->
<script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/contrib/auto-render.min.js"
    integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI"
    crossorigin="anonymous"
    onload="renderMathInElement(document.body);"
></script>
<script src="{% static_with_version "cms/js/dist/bundle.admin.base.min.js" %}"></script>
<script>
(function($) {
// CMS.$ will be passed for $
$(document).ready(function () {
    console.log("change_form.html is loading")
	CMS.API.Helpers.csrf('{{ csrf_token }}');
    let tex_in = document.getElementById("id_tex_code");
    let tex_out = document.getElementById("katex-live-render-out");
    const render_text = () => {
    let tex_code = tex_in.value;
    console.log("tex_code to render: ", tex_code);
    katex.render(tex_code, tex_out, {
        throwOnError: false
    });
    };

    tex_in.oninput = render_text;
    render_text();
});
})(CMS.$);
</script>
{% endblock %}

{% comment %} {% addtoblock "content" %} {% endcomment %}
{% block content %}
    {{ block.super }}
<br />
<span class="katex" id="katex-live-render-out">
Blub
</span>

{% endblock %}

{% comment %} {% endaddtoblock %} {% endcomment %}

